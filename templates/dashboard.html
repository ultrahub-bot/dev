<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>UltraHub Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #232946; }
        .sidebar { background: #232946; color: #fff; min-height: 100vh; padding: 2rem 1rem; }
        .sidebar h2 { color: #eebbc3; font-weight: bold; }
        .sidebar a { color: #eebbc3; text-decoration: underline; }
        .main { background: #f7f7fb; min-height: 100vh; }
        .toggle-switch { width: 2.5em; height: 1.5em; }
        .toggle-switch input { display: none; }
        .toggle-switch label { display: block; width: 100%; height: 100%; background: #ccc; border-radius: 1em; position: relative; cursor: pointer; }
        .toggle-switch label:after { content: ""; width: 1.2em; height: 1.2em; background: #fff; border-radius: 50%; position: absolute; left: 0.15em; top: 0.15em; transition: .2s; }
        .toggle-switch input:checked + label { background: #00bfae; }
        .toggle-switch input:checked + label:after { left: 1.15em; }
        .cog-folder { font-weight: bold; color: #232946; background: #eebbc3; padding: 0.2em 0.6em; border-radius: 0.5em; margin-top: 1em; }
        .cog-list { margin-bottom: 1em; }
        .dashboard-title { font-size: 2em; font-weight: bold; color: #232946; margin-bottom: 1em; }
        .save-btn { background: #00bfae; color: #fff; font-weight: bold; }
        .save-btn:hover { background: #009e8e; }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 sidebar">
            <h2>UltraHub Bot</h2>
            <hr>
            <h5>Informações Gerais</h5>
            <ul class="list-unstyled">
                <li><b>Dono:</b> {{ settings.BOT_OWNER }}</li>
                <li><b>Contato:</b> {{ settings.BOT_CONTACT }}</li>
                <li><b>Prefixo:</b> {{ settings.PREFIX }}</li>
                <li><b>Servidor:</b> <a href="{{ settings.BOT_SERVER_URL }}">{{ settings.BOT_SERVER_URL }}</a></li>
            </ul>
            <hr>
            <h5>Token do Bot</h5>
            <form method="POST">
                <input type="text" name="bot_token" value="{{ bot_token }}" class="form-control mb-2" placeholder="BOT_TOKEN">
                <button type="submit" class="btn btn-warning btn-sm">Salvar Token</button>
            </form>
        </div>
        <!-- Main -->
        <div class="col-md-9 main p-4">
            <div class="dashboard-title">Painel de Gerenciamento</div>
            <form method="POST">
                <div class="row">
                    {% for key, value in settings.items() %}
                        {% if key not in ["ENABLED_COGS", "BOT_OWNER", "BOT_CONTACT", "PREFIX", "BOT_SERVER_URL"] %}
                            <div class="col-md-4 mb-3">
                                <label class="form-label">{{ key }}</label>
                                <input type="text" name="{{ key }}" value="{{ value }}" class="form-control">
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <hr>
                <h4>Módulos (Cogs)</h4>
                {% set folders = {} %}
                {% for cog in all_cogs %}
                    {% set folder = cog.split('.')[1] if '.' in cog else 'Outros' %}
                    {% if folder not in folders %}
                        {% set _ = folders.update({folder: []}) %}
                    {% endif %}
                    {% set _ = folders[folder].append(cog) %}
                {% endfor %}
                {% for folder, cogs in folders.items() %}
                    <div class="cog-folder">{{ folder }}</div>
                    <div class="row cog-list">
                        {% for cog in cogs %}
                            <div class="col-md-4">
                                <div class="form-check form-switch toggle-switch">
                                    <input class="form-check-input" type="checkbox" id="{{ cog }}" name="cog" value="{{ cog }}"
                                        {% if cog in enabled_cogs %}checked{% endif %}>
                                    <label class="form-check-label" for="{{ cog }}">{{ cog }}</label>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
                <button type="submit" class="btn save-btn mt-3">Salvar Configurações</button>
            </form>
            <form method="POST" action="/reload" style="display:inline;">
                <button type="submit" class="btn btn-info mt-3">Recarregar Módulos</button>
            </form>
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="mt-3">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>
</body>
</html>